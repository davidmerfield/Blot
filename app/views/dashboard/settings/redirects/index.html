{{> message}}


<form method='post' class="dashboard-form" action='{{{base}}}' enctype='multipart/form-data' style="max-width: none;border: 1px solid var(--border-color);padding: 2em 2em 2em;border-radius: 4px;">

    <input type="hidden" name="_csrf" value="{{csrftoken}}" />

<input type="hidden" name="redirect" value="{{{base}}}/redirects" />
<input type="hidden" name="has_redirects" value="true" />


  <div style="display: flex;align-items: baseline;">
   
    <label style="z-index: 0;flex-grow: 1;width:auto; position: relative">
      <svg style="margin-right:3px;position:relative;top:2px;fill:currentColor;width:14px;height:14px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path d="M2 1.75C2 .784 2.784 0 3.75 0h6.586c.464 0 .909.184 1.237.513l2.914 2.914c.329.328.513.773.513 1.237v9.586A1.75 1.75 0 0 1 13.25 16h-3.5a.75.75 0 0 1 0-1.5h3.5a.25.25 0 0 0 .25-.25V4.664a.25.25 0 0 0-.073-.177l-2.914-2.914a.25.25 0 0 0-.177-.073H3.75a.25.25 0 0 0-.25.25v6.5a.75.75 0 0 1-1.5 0v-6.5Z"></path><path d="m5.427 15.573 3.146-3.146a.25.25 0 0 0 0-.354L5.427 8.927A.25.25 0 0 0 5 9.104V11.5H.75a.75.75 0 0 0 0 1.5H5v2.396c0 .223.27.335.427.177Z"></path></svg>
      Redirects</label>
    
  <a href="#!" class="minor"  id="addRedirect" style="font-size:14px;margin-right:12px;display:  block;border-radius: var(--border-radius);background-color: var(--background-color);color:var(--accent-color);border:1px solid #eeeeec;padding:0.5em 0.75em;font-weight: 600;">
    <svg style="fill:currentColor;vertical-align: middle;position:relative;top:-0.1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path d="M7.75 2a.75.75 0 0 1 .75.75V7h4.25a.75.75 0 0 1 0 1.5H8.5v4.25a.75.75 0 0 1-1.5 0V8.5H2.75a.75.75 0 0 1 0-1.5H7V2.75A.75.75 0 0 1 7.75 2Z"></path></svg>
    Add redirect
  </a>

  <a href="{{{base}}}/redirects/bulk" class="minor"  style="font-size:14px;display:  block;border-radius: var(--border-radius);background-color: var(--background-color);color:var(--accent-color);border:1px solid #eeeeec;padding:0.5em 0.75em;font-weight: 600;">
    <svg style="fill:currentColor;vertical-align: middle;position:relative;top:-0.1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path d="M11.013 1.427a1.75 1.75 0 0 1 2.474 0l1.086 1.086a1.75 1.75 0 0 1 0 2.474l-8.61 8.61c-.21.21-.47.364-.756.445l-3.251.93a.75.75 0 0 1-.927-.928l.929-3.25c.081-.286.235-.547.445-.758l8.61-8.61Zm.176 4.823L9.75 4.81l-6.286 6.287a.253.253 0 0 0-.064.108l-.558 1.953 1.953-.558a.253.253 0 0 0 .108-.064Zm1.238-3.763a.25.25 0 0 0-.354 0L10.811 3.75l1.439 1.44 1.263-1.263a.25.25 0 0 0 0-.354Z"></path></svg>
    Bulk editor
  </a>
</div>
  
<br>


<section id="stage">
  
  <section id="redirects" class="fullRow sortable" style="max-width: 100%">

    <span id="emptyRedirects" style="display: none;{{^redirects.length}}display: block;{{/redirects.length}}border:1px solid #eeeeec;text-align: center;border-radius: 4px;padding:48px 24px;font-size: var(--small-font-size);color:var(--light-text-color)"
      >
      No redirects
    </span>


    {{#redirects}}
    <section>
      <span class="handle"><svg xmlns="http://www.w3.org/2000/svg" width="8" height="16" fill="none" viewBox="0 0 8 16"><circle cx="6.5" cy="3" r="1.4" fill="currentColor" transform="rotate(90 6.5 3)"></circle><circle cx="1.5" cy="3" r="1.4" fill="currentColor" transform="rotate(90 1.5 3)"></circle><circle cx="6.5" cy="8" r="1.4" fill="currentColor" transform="rotate(90 6.5 8)"></circle><circle cx="1.5" cy="8" r="1.4" fill="currentColor" transform="rotate(90 1.5 8)"></circle><circle cx="6.5" cy="13" r="1.4" fill="currentColor" transform="rotate(90 6.5 13)"></circle><circle cx="1.5" cy="13" r="1.4" fill="currentColor" transform="rotate(90 1.5 13)"></circle></svg></span>
          <input
        class="lab"
        placeholder="/from"
        type="text"
        name="redirects.{{ index }}.from"
        value="{{ from }}" />
      <input
        class="val"
        placeholder="/to"
        type="text"
        name="redirects.{{ index }}.to"
        value="{{ to }}" />
      <a href="#!" class="removeLink">
        <svg style="fill: currentColor;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path d="M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"></path></svg>
        Delete
      </a>
    </section>
    {{/redirects}}
  </section>
</section>


<section id="new_redirect" style="display: none;">
  <span class="handle"><svg xmlns="http://www.w3.org/2000/svg" width="8" height="16" fill="none" viewBox="0 0 8 16"><circle cx="6.5" cy="3" r="1.4" fill="currentColor" transform="rotate(90 6.5 3)"></circle><circle cx="1.5" cy="3" r="1.4" fill="currentColor" transform="rotate(90 1.5 3)"></circle><circle cx="6.5" cy="8" r="1.4" fill="currentColor" transform="rotate(90 6.5 8)"></circle><circle cx="1.5" cy="8" r="1.4" fill="currentColor" transform="rotate(90 1.5 8)"></circle><circle cx="6.5" cy="13" r="1.4" fill="currentColor" transform="rotate(90 6.5 13)"></circle><circle cx="1.5" cy="13" r="1.4" fill="currentColor" transform="rotate(90 1.5 13)"></circle></svg></span>
  <input
    disabled
    class="lab"
    placeholder="/from"
    type="text"
    name="redirects.{index}.from"
    value="" />
  <input
    disabled
    class="val"
    placeholder="/to"
    type="text"
    name="redirects.{index}.to"
    value="" />
  <a href="#!" class="removeLink">
    <svg style="fill:currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" width="16" height="16"><path d="M11 1.75V3h2.25a.75.75 0 0 1 0 1.5H2.75a.75.75 0 0 1 0-1.5H5V1.75C5 .784 5.784 0 6.75 0h2.5C10.216 0 11 .784 11 1.75ZM4.496 6.675l.66 6.6a.25.25 0 0 0 .249.225h5.19a.25.25 0 0 0 .249-.225l.66-6.6a.75.75 0 0 1 1.492.149l-.66 6.6A1.748 1.748 0 0 1 10.595 15h-5.19a1.75 1.75 0 0 1-1.741-1.575l-.66-6.6a.75.75 0 1 1 1.492-.15ZM6.5 1.75V3h3V1.75a.25.25 0 0 0-.25-.25h-2.5a.25.25 0 0 0-.25.25Z"></path></svg>
    Delete</a>
</section>

<div class="clear"></div>



{{#footer}}
<script src="/js/sortable.js?{{ cacheID }}"></script>
<script type="text/javascript">
  const sortable = new Sortable(document.querySelector(".sortable"), {
    handle: ".handle",
    ghostClass: "sortable-ghost",
    onUpdate: function () {
      const sections = document.querySelectorAll(".sortable section");
      sections.forEach((section, index) => {
        const inputs = section.querySelectorAll("input");
        inputs.forEach((input) => {
          const name = input.getAttribute("name");
          const newName =
            name.slice(0, name.indexOf(".") + 1) +
            index +
            name.slice(name.lastIndexOf("."));
          input.setAttribute("name", newName);
        });
      });
    },
  });

  const redirectsContainer = document.getElementById("redirects");
  redirectsContainer.addEventListener("click", function (e) {
    if (e.target.classList.contains("removeLink")) {
      e.target.parentNode.remove();
      e.preventDefault();

      if (!redirectsContainer.querySelector("section")) {
        const emptyRedirects = document.getElementById("emptyRedirects");
        emptyRedirects.style.display = "block";
      }

      return false;
    }
  });

  function createRedirect(from) {
    // hide the empty redirects message

    const emptyRedirects = document.getElementById("emptyRedirects");
    emptyRedirects.style.display = "none";

    const index = redirectsContainer.querySelectorAll("section").length;
    const linkID = new Date().getTime();
    const newlink = document
      .getElementById("new_redirect")
      .cloneNode(true);
    newlink.removeAttribute("style");

    newlink.id += linkID;

    const inputs = newlink.querySelectorAll("input");
    inputs.forEach((input) => {
      input.removeAttribute("disabled");
    });

    const fromInput = newlink.querySelector('input[name*="from"]');
    fromInput.value = from || "";

    const indexInputs = newlink.querySelectorAll('input[name*="{index}"]');
    indexInputs.forEach((input) => {
      const name = input.getAttribute("name");
      const newName = name.split("{index}").join(index);
      input.setAttribute("name", newName);
    });

    redirectsContainer.appendChild(newlink);

    if (from) {
      newlink.querySelector('input[name*="to"]').focus();
    } else {
      newlink.querySelector('input[name*="from"]').focus();
    }

    e.preventDefault();
    return false;
  }

  const addRedirectButton = document.getElementById("addRedirect");

  addRedirectButton.addEventListener("click", function (e) {
    e.preventDefault();
    createRedirect();
    return false;
  });

  // extract a new redirect from the query 'create'
  // if it exists, and remove it from the query
  const url = new URL(window.location.href);
  const create = url.searchParams.get("create");
  if (create) {
    url.searchParams.delete("create");
    window.history.replaceState({}, "", url.toString());
    createRedirect(create);
  }
</script>
{{/footer}}








<div class="buttons">
	<button type="submit" onclick="this.form.submit();this.disabled=true">
		Save changes
	</button>
	<a href="{{{base}}}">Cancel</a>
</div>
<br><Br>

<a
href="/how/configure/redirects"
style="
  color: var(--accent-color);
  line-height: 40px;
  display: block;
  border-top: 1px solid rgba(0, 0, 0, 0.05);
">
Guide to redirects <span style="float: right">&rarr;</span>
</a>
<a
  href="{{{base}}}/redirects/404s"
  style="
    color: var(--accent-color);
    line-height: 40px;
    display: block;
    border-top: 1px solid rgba(0, 0, 0, 0.05);
  ">
  404 log <span style="float: right">&rarr;</span>
</a>

</form>

{{#links_for_footer}}
{{{html}}}
{{/links_for_footer}}
<script type="text/javascript">document.querySelectorAll(".buttons a, .buttons input, .buttons button").forEach(function(a){a.addEventListener("click",function(a){a.target.classList.add("disabled")})})
</script>
