# Changelog

## v0.33 - *gauge*

Requires libvips v8.15.3

### v0.33.5 - 16th August 2024

- Upgrade to libvips v8.15.3 for upstream bug fixes.
- Add `pageHeight` and `pages` to response of multi-page output. [#3411](https://github.com/lovell/sharp/issues/3411)
- Ensure option to force use of a globally-installed libvips works correctly. [#4111](https://github.com/lovell/sharp/issues/4111)  
  *@project0*
- Minimise use of engines property to improve Yarn v1 support. [#4130](https://github.com/lovell/sharp/issues/4130)
- Ensure `sharp.format.heif` includes only AVIF when using prebuilt binaries. [#4132](https://github.com/lovell/sharp/issues/4132)
- Add support to `recomb` operation for 4x4 matrices. [#4147](https://github.com/lovell/sharp/issues/4147)  
  *@ton11797*
- Expose PNG text chunks as comments metadata. [#4157](https://github.com/lovell/sharp/issues/4157)  
  *@nkeynes*
- Expose optional `precision` and `minAmplitude` parameters of blur operation. [#4168](https://github.com/lovell/sharp/issues/4168)  
  [#4172](https://github.com/lovell/sharp/issues/4172) *@marcosc90*
- Ensure `keepIccProfile` avoids colour transformation where possible. [#4186](https://github.com/lovell/sharp/issues/4186)
- TypeScript: `chromaSubsampling` metadata is optional. [#4191](https://github.com/lovell/sharp/issues/4191)  
  *@DavidVaness*

---

### v0.33.4 - 16th May 2024

- Remove experimental status from `pipelineColourspace`.
- Reduce default concurrency when musl thread over-subscription is detected.
- TypeScript: Add missing definitions for `OverlayOptions`. [#4048](https://github.com/lovell/sharp/issues/4048)  
  *@ike-gg*
- Install: Add advanced option to force use of a globally-installed libvips. [#4060](https://github.com/lovell/sharp/issues/4060)
- Expose bilinear resizing kernel (and interpolator). [#4061](https://github.com/lovell/sharp/issues/4061)
- Ensure `extend` operation stays sequential for multi-page TIFF (regression in 0.32.0). [#4069](https://github.com/lovell/sharp/issues/4069)
- Tighten validation of constructor text integer properties. [#4071](https://github.com/lovell/sharp/issues/4071)
- Simplify internal `StaySequential` logic. [#4074](https://github.com/lovell/sharp/issues/4074)  
  *@kleisauke*
- Ensure `negate` operation occurs after profile conversion. [#4096](https://github.com/lovell/sharp/issues/4096)  
  *@adriaanmeuris*

---

### v0.33.3 - 23rd March 2024

- Upgrade to libvips v8.15.2 for upstream bug fixes.
- Ensure `keepIccProfile` retains P3 and CMYK input profiles. [#3906](https://github.com/lovell/sharp/issues/3906)  
  [#4008](https://github.com/lovell/sharp/issues/4008)
- Ensure `text.wrap` property can accept `word-char` as a value. [#4028](https://github.com/lovell/sharp/issues/4028)  
  *@yolopunk*
- Ensure `clone` takes a deep copy of existing options. [#4029](https://github.com/lovell/sharp/issues/4029)
- Add `bitdepth` option to HEIF output (prebuilt binaries support 8-bit only). [#4036](https://github.com/lovell/sharp/issues/4036)  
  *@mertalev*

---

### v0.33.2 - 12th January 2024

- Upgrade to libvips v8.15.1 for upstream bug fixes.
- TypeScript: Add definition for `keepMetadata`. [#3914](https://github.com/lovell/sharp/issues/3914)  
  *@abhi0498*
- Ensure `extend` operation stays sequential when copying (regression in 0.32.0). [#3928](https://github.com/lovell/sharp/issues/3928)
- Improve error handling for unsupported multi-page rotation. [#3940](https://github.com/lovell/sharp/issues/3940)

---

### v0.33.1 - 17th December 2023

- Add support for Yarn Plug'n'Play filesystem layout. [#3888](https://github.com/lovell/sharp/issues/3888)
- Emit warning when attempting to use invalid ICC profiles. [#3895](https://github.com/lovell/sharp/issues/3895)
- Ensure `VIPS_NOVECTOR` environment variable is respected. [#3897](https://github.com/lovell/sharp/issues/3897)  
  *@icetee*

---

### v0.33.0 - 29th November 2023

- Drop support for Node.js 14 and 16. Now requires Node.js ^18.17.0 or >= 20.3.0.
- Prebuilt binaries distributed via npm registry and installed via package manager.
- Building from source requires dependency on `node-addon-api`.
- Remove `sharp.vendor`.
- Partially deprecate `withMetadata()`. Use `withExif()` and `withIccProfile()` instead.
- Add experimental support for WebAssembly-based runtimes. *@RReverser*
- Options for `trim` operation must be an Object. Add new `lineArt` option. [#2363](https://github.com/lovell/sharp/issues/2363)
- Improve luminance of `tint` operation with weighting function. [#3338](https://github.com/lovell/sharp/issues/3338)  
  *@jcupitt*
- Ensure all `Error` objects contain a `stack` property. [#3653](https://github.com/lovell/sharp/issues/3653)
- Make `compression` option of HEIF mandatory to reduce HEIF vs HEIC confusion. [#3740](https://github.com/lovell/sharp/issues/3740)
- Ensure correct interpretation of 16-bit raw input. [#3808](https://github.com/lovell/sharp/issues/3808)
- Add support for `miniswhite` when using TIFF output. [#3812](https://github.com/lovell/sharp/issues/3812)  
  *@dnsbty*
- TypeScript: Add missing definition for `withMetadata` boolean. [#3823](https://github.com/lovell/sharp/issues/3823)  
  *@uhthomas*
- Add more fine-grained control over output metadata. [#3824](https://github.com/lovell/sharp/issues/3824)
- Ensure multi-page `extract` remains sequential. [#3837](https://github.com/lovell/sharp/issues/3837)

---

## v0.32 - *flow*

Requires libvips v8.14.5