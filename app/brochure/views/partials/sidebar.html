<nav>
   <input type="checkbox" name="toggle" id="toggle">
   <label for="toggle">
      <svg id="shower" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 45 45" preserveAspectRatio="" class="app-header__menu-icon block absolute inset-0 h-full w-full" style="">
         <g fill="currentColor" fill-rule="evenodd">
            <path d="M10 15h25v1H10zM10 22h25v1H10zM10 29h25v1H10z"></path>
         </g>
      </svg>
      <svg id="hider" style="width: 1.5em; height: 1.5em;">
         <line x1="0" y1="0" x2="100%" y2="100%" stroke="currentColor"></line>
         <line x1="0" y1="100%" x2="100%" y2="0%" stroke="currentColor"></line>
      </svg>
   </label>
   <ul class="sidebar"style="margin-bottom: 2rem">
      <li><a class="{{selected}}" href="/">Home</a></li>
      <li><a class="{{selected}}" href="/sign-up">Create a blog</a></li>
   </ul>
   <ul class="sidebar" >
      <li>
         <a style="border-top:none" class="{{selected.howIndex}}" data-open="{{selected.how}}" href="/how">How it works</a>
         <ul>
            <li><a class="{{selected.pages}}" href="/how/pages">Pages</a></li>
            <li><a class="{{selected.metadata}}" href="/how/metadata">Metadata</a></li>
            <li>
               <a class="{{selected.clientsIndex}}" data-open="{{selected.clients}}"  href="/how/clients">Clients</a>
               <ul>
                  <li><a class="{{selected.dropbox}}" href="/how/clients/dropbox">Dropbox</a></li>
                  <li><a class="{{selected.git}}" href="/how/clients/git">Git</a></li>
               </ul>
            </li>
            <li>
               <a class="{{selected.guidesIndex}}" data-open="{{selected.guides}}" href="/how/guides">Guides</a>
               <ul>
                  <li><a class="{{selected.markdown}}" href="/how/guides/markdown">Markdown</a></li>
                  <li><a class="{{selected.layout-tags}}" href="/how/guides/layout-tags">Layout</a></li>
                  <li><a class="{{selected.tex}}" href="/how/guides/tex">\(\TeX\)</a></li>
                  <li><a class="{{selected.embedding}}" href="/how/guides/embedding">Embedding</a></li>
                  <li><a class="{{selected.citations}}" href="/how/guides/citations">Citations</a></li>
               </ul>
            </li>
            <li>
               <a class="{{selected.configureIndex}}" data-open="{{selected.configure}}" href="/how/configure">Configure your site</a>
               <ul>
                  <li><a class="{{selected.domain}}" href="/how/configure/domain">Domain</a></li>
                  <li><a class="{{selected.analytics}}" href="/how/configure/analytics">Analytics</a></li>
                  <li><a class="{{selected.comments}}" href="/how/configure/comments">Comments</a></li>
                  <li><a class="{{selected.redirects}}" href="/how/configure/redirects">Redirects</a></li>
                  <li><a class="{{selected.urls}}" href="/how/configure/urls">URL format</a></li>
               </ul>
            </li>
         </ul>
      </li>
      <li>
         <a class="{{selected.templatesIndex}}" data-open="{{selected.templates}}" href="/templates">Templates</a>
         <ul>
            <li><a class="{{selected.diary}}" href="/templates/diary">Diary</a></li>
            <li><a class="{{selected.essay}}" href="/templates/essay">Essay</a></li>
            <li><a class="{{selected.picture}}" href="/templates/picture">Picture</a></li>
            <li><a class="{{selected.magazine}}" href="/templates/magazine">Magazine</a></li>
            <li><a class="{{selected.scrapbook}}" href="/templates/scrapbook">Scrapbook</a></li>
            <li >
               <a  class="{{selected.developersIndex}}" data-open="{{selected.developers}}" href="/templates/developers"><span style="margin-top:4px;padding-top:4px;display:inline-block;border-top:1px solid var(--light-border-color)">Developer guide</span></a>
               <ul>
                  <li><a class="{{selected.how-blot-works}}" href="/templates/developers/how-blot-works">How it works</a></li>
                  <li><a class="{{selected.rendering-templates}}"  href="/templates/developers/rendering-templates">Rendering templates</a></li>
                  <li>
                     <a class="{{selected.guidesIndex}}" data-open="{{selected.guides}}" href="/templates/developers/guides">Guides</a>
                     <ul>
                        <li><a class="{{selected.json-feed}}" href="/templates/developers/guides/json-feed">JSON feed</a></li>
                        <li><a class="{{selected.group-posts-by-date}}" href="/templates/developers/guides/group-posts-by-dates">Group posts by date</a></li>
                        <li><a class="{{selected.posts-tagged}}" href="/templates/developers/guides/posts-tagged">All posts with a tag</a></li>
                     </ul>
                  </li>
                  <li>
                     <a class="{{selected.referenceIndex}}" data-open="{{selected.reference}}"  href="/templates/developers/reference">Reference</a>
                     <ul>
                        <li><a class="{{selected.blog}}" href="/templates/developers/reference/blog">Blog</a></li>
                        <li><a class="{{selected.entry}}" href="/templates/developers/reference/entry">Entry</a></li>
                        <li><a class="{{selected.lists}}" href="/templates/developers/reference/lists">Lists</a></li>
                        <li><a class="{{selected.helper-functions}}" href="/templates/developers/reference/helper-functions">Helper functions</a></li>
                        <li><a class="{{selected.date-tokens}}" href="/templates/developers/reference/date-tokens">Date tokens</a></li>
                     </ul>
                  </li>
               </ul>
            </li>
         </ul>
      </li>
      <li>
         <a class="{{selected.aboutIndex}}" data-open="{{selected.about}}" href="/about">About</a>
         <ul>
            <li><a class="{{selected.news}}" href="/about/news">News</a></li>
            <li><a class="{{selected.source-code}}" href="/about/source-code">Source code</a></li>
            <li>
               <a class="{{selected.notesIndex}}" href="/about/notes" data-open="{{selected.notes}}">Notes</a>
               <ul>
                  <li>
                     <a class="{{selected.businessIndex}}" data-open="{{selected.business}}" href="/about/notes/business">Business</a>
                     <ul>
                        <li><a class="{{selected.customer-service}}" href="/about/notes/business/customer-service">Customer service</a></li>
                        <li><a class="{{selected.marketing}}" href="/about/notes/business/marketing">Marketing</a></li>
                        <li><a class="{{selected.project-management}}" href="/about/notes/business/project-management">Project management</a></li>
                        <li><a class="{{selected.revenue-model}}" href="/about/notes/business/revenue-model">Revenue model</a></li>
                     </ul>
                  </li>
                  <li>
                     <a class="{{selected.designIndex}}" data-open="{{selected.design}}" href="/about/notes/design">Design</a>
                     <ul>
                        <li><a class="{{selected.aesthetic}}" href="/about/notes/design/aesthetic">Aesthetic</a></li>
                        <li><a class="{{selected.irritating-websites}}" href="/about/notes/design/irritating-websites">Irritating websites</a></li>
                        <li><a class="{{selected.sign-up}}" href="/about/notes/design/sign-up">Sign up page</a></li>
                        <li><a class="{{selected.templates}}" href="/about/notes/design/templates">Testhetic</a></li>
                     </ul>
                  </li>
                  <li>
                     <a class="{{selected.politicsIndex}}" data-open="{{selected.politics}}" href="/about/notes/politics">Politics</a>
                     <ul>
                        <li><a class="{{selected.censorship}}" href="/about/notes/politics/censorship">Censorship</a></li>
                        <li><a class="{{selected.open-source}}" href="/about/notes/politics/open-source">Open source</a></li>
                     </ul>
                  </li>
                  <li>
                     <a class="{{selected.programmingIndex}}" data-open="{{selected.programming}}" href="/about/notes/programming">Programming</a>
                     <ul>
                        <li><a class="{{selected.front-end-philosophy}}" href="/about/notes/programming/front-end-philosophy">Front-end philosophy</a></li>
                        <li><a class="{{selected.generating-titles}}" href="/about/notes/programming/generating-titles">Generating titles</a></li>
                        <li><a class="{{selected.responsive-images}}" href="/about/notes/programming/responsive-images">Responsive images</a></li>
                        <li><a class="{{selected.unlimited-bandwidth}}" href="/about/notes/programming/unlimited-bandwidth">Unlimited bandwidth</a></li>
                        <li><a class="{{selected.why-use-a-cdn}}" href="/about/notes/programming/why-use-a-cdn">Slow images</a></li>
                     </ul>
                  </li>
               </ul>
            </li>
         </ul>
      </li>
      <li><a class="{{selected.questions}}" href="/questions">Questions</a></li>
      <li><a class="{{selected.support}}" href="/support">Support</a></li>
   </ul>
   {{#if headers.length}}
   {{#if show-on-this-page}}
   <section class="on-this-page">
      On this page
      <ul>
         {{#headers}}
         <li class="{{#if first}}selected{{/if}}">
            <a href="#{{id}}" class="scroll" style="border-bottom: none;">{{text}}</a>
         </li>
         {{/headers}}
      </ul>
   </section>
   {{/if}}
   {{/if}}
</nav>
<script type="text/javascript">
   var sidebarLinks = document.querySelectorAll('.sidebar a');
   
   sidebarLinks.forEach(function(targetNode){
     var ignore = [
       targetNode, 
       targetNode.parentNode.parentNode.previousElementSibling,
       targetNode.parentNode.parentNode.parentNode.parentNode.previousElementSibling]; 
     
     console.log(targetNode, ignore);
     targetNode.addEventListener('click', function (e) {
       sidebarLinks.forEach(function(node){
         if (ignore.indexOf(node) > -1) return;
         node.setAttribute('data-open', '');
       });
     });
   
     targetNode.addEventListener('mousedown', function (e) {
       sidebarLinks.forEach(function(node){
         node.classList.remove('selected');
       });
     });
   });
   
   
     (function() {
     scrollTo();
   })();
   
   // Smooth scrolling
   function scrollTo() {
     const links = document.querySelectorAll('.scroll');
     links.forEach(each => (each.onclick = scrollAnchors));
   }
   
   function scrollAnchors(e, respond = null) {
     const distanceToTop = el => Math.floor(el.getBoundingClientRect().top);
     e.preventDefault();
     var targetID = (respond) ? respond.getAttribute('href') : this.getAttribute('href');
     const targetAnchor = document.querySelector(targetID);
     if (!targetAnchor) return;
     const originalTop = distanceToTop(targetAnchor);
     window.scrollBy({ top: originalTop, left: 0, behavior: 'smooth' });
     const checkIfDone = setInterval(function() {
       const atBottom = window.innerHeight + window.pageYOffset >= document.body.offsetHeight - 2;
       if (distanceToTop(targetAnchor) === 0 || atBottom) {
         targetAnchor.tabIndex = '-1';
         targetAnchor.focus();
         window.history.pushState('', '', targetID);
         clearInterval(checkIfDone);
       }
     }, 100);
   }
   
   
   
   // Highlight active section
   
     const links = [];
     const offsets = [];
     const titles = [];
   
     document.querySelectorAll('.scroll').forEach(function(link){
       var id = link.href.slice(link.href.indexOf('#') + 1);
       var title = document.getElementById(id);
       var offset = window.pageYOffset + title.getBoundingClientRect().top;
       titles.push(title);
       offsets.push(offset);
       links.push(link);
     });
   
     function highlightActiveSection () {
       var offset = window.pageYOffset;
       var minDiff;
       var minDiffI;
       offsets.forEach(function(titleOffset, i){
         var diff = Math.abs(titleOffset - offset);
         if (minDiff === undefined) {
           minDiff = diff;
           minDiffI = i;
         } else if (titleOffset > offset && diff < minDiff) {
           minDiff = diff;
           minDiffI = i;
         } else {
           return false;
         }
       });
   
       links.forEach(function(link, i){
         if (i === minDiffI) {
           link.parentNode.classList.add("selected");
         } else {
           link.parentNode.classList.remove("selected");
         }
       });
     }
   
     window.onscroll = highlightActiveSection;
   
   
</script>